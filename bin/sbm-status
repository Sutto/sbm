#!/usr/bin/env ruby
require_relative './coordination'

def usage
  STDERR.puts "Usage: #$0"
  exit 1
end

coordinator, worker = Coordination.defaults

puts "Known Workers: #{coordinator.workers.sort_by(&:name).join(", ")}"
puts ""
puts ""
coordinator.batches.each do |batch|
  started   = coordinator.started_workers_for_batch batch
  completed = coordinator.started_workers_for_batch completed
  puts "Batch: #{batch}"
  puts "Number Started:   #{started.size}"
  puts "Number Completed: #{completed.size}"
  puts "Number Pending:   #{started.size - completed.size}"
  puts "---"
  puts "Started:   #{started.sort_by(&:name).join(", ")}"
  puts "Completed: #{completed.sort_by(&:name).join(", ")}"
  puts ""
end
